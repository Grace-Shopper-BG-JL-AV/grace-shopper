language: node_js
node_js:
  - 12 # uses version 12
services:
  - postgresql # starts up postgres
addons:
  postgresql: '10' # recent postgres version on Travis
dist: xenial # uses xenial environment
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "grace-shopper-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)
script:
  - npm test # test the code
  - npm run build-client # make the bundle
before_deploy: # omit node_modules, since we set skip_cleanup below
  - rm -rf node_modules
deploy: # see README for details on these keys
  # prevents travis from deleting the build
  skip_cleanup: true
  provider: heroku
  # app should be your heroku app name; see README
  app: hallowoof
  # the secure key indicates an encrypted value; see README
  api_key:
    secure: vST84VsDRZdKMutPi/f6Jgta1Ul4myZRiJHHiJkmO+bX9zIAOmwST+BxlzShbq1ND4N7NHdqDCGYev/XjHB0bZEfnntX0v8fExC5PgW1/hysYVCSqH3Ty/IV7iYtXsaydkUijR41ldqTFNoEAPi3+Il2WbQywP7hTh4lVSnpnp2oZ8l9as0Xxb87ZfSXSwjtooiTdk46zNGG5xWr/fioNjsgWOs8GX5q9TA1BWAX31Av0l/J0iJVZXo2c0/nF+LNXLKJdOV94A3GeIkizaI7EOE26Zw4C5E/KFMpL9K2abOP1iOrmuipI0Hsdw9WZ8XdKR8wpYi7fUO/u/ZZSrAVNZHiJe1+y0sbiDKCojslBp7pItiXWfDuXGmOR0jRjvyHzzvZfNCJSDFfRZuxEZdQag0agBwsIKio3zP3KGhapmtTEwbNnZWKhSyLfLpi7hSWBhDbabEZEleGWR6KoJOd8kgBd/C6qPCYvm66415H+1lZ37aZ7ecWxTu+a4+l8In734Hskfn9E80GJ3yQKUy75o8XhU98VpEkxyKvckm7O0xaMxYiH0uBHBBV6uaXyRQa3q8GR/6xiW/Zf5Xt2sx27Lc2pjJCrhYCWTDe+bJk+gMDxall1FWxTiaX9i/BX3jK0KWIQxFujZlwULmPULwqh5FVgonpK5JPbxvSt27AW9U=
